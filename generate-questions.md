# ChatGPTによる問題生成ガイド

この文書では、ChatGPTを使ってDBスペシャリスト試験問題を効率的に生成する手順を説明します。

## 🚀 クイックスタート（5分で30問生成）

### ステップ1: ChatGPTに基本設定を送信

```markdown
あなたはデータベーススペシャリスト試験の問題作成エキスパートです。

以下の完全なJSONスキーマに従って、実際の試験レベルの高品質な問題を作成してください：

**JSONスキーマ（questions-schema.json準拠）:**

必須のデータ構造と制約事項：

1. **セクション（sections）**
   - id: 小文字とハイフンのみ（例: "database-design", "sql"）
   - title: セクション名（例: "データベース設計"）
   - questions: 問題配列（最低1問）

2. **問題（questions）**
   - id: "q数字-数字"形式（例: "q1-1", "q2-5"）
   - number: "問題 数字-数字"形式（例: "問題 1-1"）
   - type: "single_choice", "multiple_choice", "essay"のいずれか
   - question: 問題文（最低10文字）
   - choices: 選択肢配列（記述式以外、2-8個）
   - correct: 正解（単一="a", 複数=["a","c"], 記述式=""）
   - explanation: 解説（最低10文字）

3. **選択肢（choices）**
   - value: a-hの1文字
   - text: 選択肢テキスト

**スキーマ検証ルール:**
- 単一選択・複数選択問題には必ずchoicesが必要
- 記述式問題ではchoicesは不要、correctは空文字
- IDはすべて一意である必要がある
- パターン形式は厳密に守る

**品質要件:**
- 実際のDBスペシャリスト試験レベルの難易度
- 明確で曖昧さのない問題文
- 教育的価値の高い解説
- 最新のDB技術動向を反映

**出力要求:**
生成したJSONは必ずスキーマに完全準拠すること。

準備完了なら「理解しました。スキーマに準拠した問題を作成します。」と返答してください。
```

### ステップ2: 全分野一括生成プロンプト

```markdown
DBスペシャリスト試験の全6分野30問を一括生成してください。

**出力形式:** 完全なquestions.json形式

**分野構成:**
1. **データベース設計** (id: "database-design")
   - 概念設計、論理設計、物理設計、E-R図
   - 単一選択3問、複数選択1問、記述式1問

2. **SQL** (id: "sql") 
   - SELECT文、DML、DDL、関数、高度なSQL
   - 単一選択3問、複数選択1問、記述式1問

3. **正規化・データモデリング** (id: "normalization")
   - 各正規形、関数従属性、BCNF、実践的適用
   - 単一選択3問、複数選択1問、記述式1問

4. **性能・チューニング** (id: "performance")
   - インデックス、実行計画、最適化、パーティショニング
   - 単一選択3問、複数選択1問、記述式1問

5. **セキュリティ** (id: "security")
   - アクセス制御、SQLインジェクション、暗号化、監査
   - 単一選択3問、複数選択1問、記述式1問

6. **トランザクション・同期処理** (id: "transaction")
   - ACID特性、分離レベル、ロック、デッドロック
   - 単一選択3問、複数選択1問、記述式1問

**問題ID規則:** q[分野番号]-[問題番号] (例: q1-1, q1-2, ..., q6-5)

**記述式問題の例:**
- "○○について300字以内で説明せよ"
- "具体例を挙げて○○の利点と注意点を述べよ"

**重要: questions-schema.json準拠**
- 全ての制約事項を厳密に守ること
- 問題タイプ別の要件を満たすこと
- IDパターンを正確に適用すること

完全なJSONファイルを出力してください。
```

### ステップ3: 品質向上プロンプト（オプション）

```markdown
生成された問題の品質をさらに向上させてください：

**改善ポイント:**
1. **問題文の具体性向上** - 抽象的な表現を具体的なシナリオに
2. **選択肢の精度向上** - より巧妙なダミー選択肢の設定
3. **解説の充実** - 理由だけでなく、関連知識や実務での重要性も追加
4. **実務志向の強化** - 暗記よりも理解と応用を重視

**具体的要求:**
- 各問題に実際のシステム設計シナリオを含める
- 解説には「なぜそうなるのか」の論理的説明を必須とする
- 複数選択問題では部分点の概念も考慮
- 記述式問題では採点基準も明記

修正版の完全なJSONファイルを出力してください。
```

## 📝 分野別詳細プロンプト

より専門的な問題が必要な場合は、以下の分野別プロンプトを使用してください：

### データベース設計分野（高度版）

```markdown
データベース設計分野の高度な問題を5問作成してください。

**重点領域:**
- 概念設計: エンティティ識別、カーディナリティ、弱エンティティ
- 論理設計: 正規化判断、ビジネスルール実装、制約設計
- 物理設計: インデックス戦略、パーティション設計、ストレージ選択
- 設計パターン: スタースキーマ、スノーフレーク、テンポラルデータ

**問題レベル:** 高度（実務経験3年以上想定）

**出力:** セクションのJSON部分のみ
```

### SQL分野（実践版）

```markdown
SQL分野の実践的な問題を5問作成してください。

**重点領域:**
- 高度なJOIN: 外部結合、自己結合、クロス結合の使い分け
- ウィンドウ関数: ROW_NUMBER, RANK, LAG/LEAD, 累積計算
- CTE: 再帰CTE、複雑なデータ変換
- パフォーマンス: 実行計画読解、インデックス活用
- 実務SQL: データクレンジング、レポート作成

**実際のテーブル例を使用:**
```sql
-- 顧客テーブル
CREATE TABLE customers (
  customer_id INT PRIMARY KEY,
  name VARCHAR(100),
  region VARCHAR(50),
  registration_date DATE
);

-- 注文テーブル  
CREATE TABLE orders (
  order_id INT PRIMARY KEY,
  customer_id INT,
  order_date DATE,
  amount DECIMAL(10,2)
);
```

**出力:** セクションのJSON部分のみ
```

## 🔧 生成後の作業

### 1. JSONスキーマ検証

生成されたJSONファイルは必ずスキーマ検証を行ってください：

#### Node.js + ajv-cli での検証
```bash
# ajv-cliのインストール
npm install -g ajv-cli

# スキーマ検証の実行
ajv validate -s questions-schema.json -d questions.json

# 成功例
questions.json valid

# エラー例
questions.json invalid
data/sections/0/questions/0/id should match pattern "^q[0-9]+-[0-9]+$"
```

#### オンラインJSONスキーマバリデーター
1. https://www.jsonschemavalidator.net/ にアクセス
2. 左側に `questions-schema.json` の内容をペースト
3. 右側に生成された `questions.json` をペースト
4. 検証結果を確認

#### よくあるスキーマエラーと対処法

**エラー1: IDパターン不一致**
```
Error: data/sections/0/questions/0/id should match pattern "^q[0-9]+-[0-9]+$"
```
対処法: 問題IDを "q1-1", "q2-3" 形式に修正

**エラー2: 問題番号フォーマット**
```
Error: data/sections/0/questions/0/number should match pattern "^問題 [0-9]+-[0-9]+$"
```
対処法: 問題番号を "問題 1-1" 形式に修正

**エラー3: 選択肢値の範囲外**
```
Error: data/sections/0/questions/0/choices/0/value should match pattern "^[a-h]$"
```
対処法: 選択肢のvalueをa-hの範囲内に修正

**エラー4: 記述式問題の制約違反**
```
Error: data/sections/0/questions/0 should NOT have additional properties
```
対処法: 記述式問題からchoicesプロパティを削除

### 2. VS Codeでの編集設定
`.vscode/settings.json`:
```json
{
  "json.schemas": [
    {
      "fileMatch": ["questions.json"],
      "url": "./questions-schema.json"
    }
  ]
}
```

### 3. 動作確認チェックリスト
- [ ] JSONが正しく読み込まれる
- [ ] 各問題タイプが正しく表示される
- [ ] 解答ボタンが動作する
- [ ] レスポンシブデザインが適用される
- [ ] 日本語が正しく表示される

## ⚡ トラブルシューティング

### よくある問題と解決法

1. **JSONパースエラー**
   - コンマの位置を確認
   - クォートの対応を確認
   - オンラインJSONバリデーターで検証

2. **問題が表示されない**
   - ブラウザの開発者ツールでエラー確認
   - questions.jsonのパスが正しいか確認
   - CORSエラーの場合はローカルサーバーを使用

3. **文字化け**
   - UTF-8エンコーディングで保存
   - HTMLのcharset指定を確認

## 💡 高度な活用法

### A. 難易度調整プロンプト
```markdown
現在の問題の難易度を段階的に調整してください：

**レベル1（基礎）:** 用語の理解、基本概念
**レベル2（標準）:** 実際の試験レベル  
**レベル3（応用）:** 実務での判断力が必要

各問題にdifficulty: "basic|standard|advanced"を追加し、
レベル2中心に調整してください。
```

### B. 時事問題対応プロンプト
```markdown
2024年の最新DB技術動向を反映した問題を追加してください：

**対象技術:**
- クラウドデータベース（AWS RDS、Azure SQL、Google Cloud SQL）
- NoSQL（MongoDB、Cassandra、DynamoDB）
- NewSQL（TiDB、CockroachDB）
- データレイク・データウェアハウス現代化

既存問題は維持し、新しい問題を各分野に1問ずつ追加してください。
```

## 📊 スキーマ準拠チェックリスト

ChatGPTで問題を生成した後、以下のチェックリストで検証してください：

### ✅ 構造チェック
- [ ] `sections` 配列が存在する
- [ ] 各セクションに `id`, `title`, `questions` がある
- [ ] 各問題に必須フィールドがすべて存在する

### ✅ ID/命名規則チェック
- [ ] セクションID: 小文字とハイフン（例: `database-design`）
- [ ] 問題ID: `q数字-数字`形式（例: `q1-1`）
- [ ] 問題番号: `問題 数字-数字`形式（例: `問題 1-1`）

### ✅ 問題タイプ別チェック
- [ ] 単一選択: `type: "single_choice"`, `correct: "a"`
- [ ] 複数選択: `type: "multiple_choice"`, `correct: ["a", "c"]`
- [ ] 記述式: `type: "essay"`, `correct: ""`, `choices`なし

### ✅ 選択肢チェック
- [ ] `value`がa-hの範囲内
- [ ] 各問題で重複なし
- [ ] `text`が空でない

### ✅ 内容品質チェック
- [ ] 問題文が10文字以上
- [ ] 解説が10文字以上
- [ ] 適切な難易度レベル
- [ ] 日本語として自然

## 🎯 完璧なワークフロー

1. **ChatGPTプロンプト送信** → 問題生成
2. **JSONスキーマ検証** → エラー修正
3. **チェックリスト確認** → 品質確保
4. **ブラウザ動作確認** → 最終チェック
5. **本番環境デプロイ** → 完了

これで効率的に高品質なDBスペシャリスト試験問題を生成できます！